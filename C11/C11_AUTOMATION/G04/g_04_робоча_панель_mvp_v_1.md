# G04 вЂ” Р РѕР±РѕС‡Р° РџР°РЅРµР»СЊ (MVP v1.0)

**РЎС‚Р°С‚СѓСЃ:** ACTIVE вЂў **Р’РµСЂСЃС–СЏ:** v1.0 вЂў **Р”Р°С‚Р°/С‡Р°СЃ (РљРёС—РІ):** 2025вЂ‘09вЂ‘03 вЂў **Р’Р»Р°СЃРЅРёРє:** G04вЂ‘Coordinator (TBD) вЂў **РЎРµРєСЂРµС‚Р°СЂ:** (TBD)

**РџСЂРёР·РЅР°С‡РµРЅРЅСЏ:** РћРїРµСЂР°С†С–Р№РЅРёР№ С†РµРЅС‚СЂ РєРѕРѕСЂРґРёРЅР°С†С–С— DAOвЂ‘GOGS. РЁРІРёРґРєРёР№ РѕРіР»СЏРґ РєСЂРёС‚РёС‡РЅРёС…/С‚РµСЂРјС–РЅРѕРІРёС…/РїР»Р°РЅРѕРІРёС… Р·Р°РІРґР°РЅСЊ, РїСЂРѕС‚РѕРєРѕР»С–РІ, Р·РІС–С‚С–РІ С‚Р° С–РЅС‚РµРіСЂР°С†С–Р№.

---

## рџљЁ РљСЂРёС‚РёС‡РЅС– Р·Р°РІРґР°РЅРЅСЏ (48 РіРѕРґ)
> SLA: РѕРЅРѕРІР»РµРЅРЅСЏ СЃС‚Р°С‚СѓСЃС–РІ РЅРµ СЂС–РґС€Рµ, РЅС–Р¶ РєРѕР¶РЅС– 12 РіРѕРґ.

- [ ] **G04вЂ‘TвЂ‘20250903вЂ‘C01** вЂ” Р’РёРїСЂР°РІРёС‚Рё РїРѕСЂРѕР¶РЅС– ZIP Сѓ СЂРµР»С–Р·Р°С… DAOвЂ‘Gallery (`SYMBOLS/ANIM/BRAND`), РїРµСЂРµРІС–СЂРёС‚Рё `dist` С– assets Сѓ Release вЂ” **РІС–РґРїРѕРІС–РґР°Р»СЊРЅРёР№:** РЎ.Р§. вЂ” **ETA:** 04.09, 18:00 вЂ” **РЎС‚Р°С‚СѓСЃ:** InвЂ‘Progress вЂ” **РџСЂРёРјС–С‚РєР°:** РґРёРІ. Р»РѕРіРё 2025вЂ‘09вЂ‘02 (DAOвЂ‘Gallery)
- [ ] **G04вЂ‘TвЂ‘20250903вЂ‘C02** вЂ” Р—Р°РІРµСЂС€РёС‚Рё РЅР°Р»Р°С€С‚СѓРІР°РЅРЅСЏ branch protection РґР»СЏ `Checha-hub-DAO/checha_core` (required checks, min approvals) вЂ” **РІС–РґРїРѕРІС–РґР°Р»СЊРЅРёР№:** РЎ.Р§. вЂ” **ETA:** 04.09, 20:00 вЂ” **РЎС‚Р°С‚СѓСЃ:** InвЂ‘Progress вЂ” **РџСЂРёРјС–С‚РєР°:** РґРёРІ. 0902T08 CI/CD
- [ ] **G04вЂ‘TвЂ‘20250903вЂ‘C03** вЂ” Р’РёРїСЂР°РІРёС‚Рё РїР°СЂР°РјРµС‚СЂРё Сѓ `tools/check_release.ps1` (СѓР·РіРѕРґРёС‚Рё РЅР°Р·РІРё/РїР°СЂР°РјРµС‚СЂРё; С‚РµСЃС‚ С–Р· `ethno-v1.2`) вЂ” **РІС–РґРїРѕРІС–РґР°Р»СЊРЅРёР№:** РЎ.Р§. вЂ” **ETA:** 05.09, 12:00 вЂ” **РЎС‚Р°С‚СѓСЃ:** Pending вЂ” **РџСЂРёРјС–С‚РєР°:** РїРѕРјРёР»РєР° `-ZipName`

### рџ“Њ РџСЂРѕРїРѕР·РёС†С–С— РґР»СЏ СЃС‚Р°СЂС‚РѕРІРѕРіРѕ РЅР°РїРѕРІРЅРµРЅРЅСЏ (СЃРєРѕСЂРёРіСѓР№С‚Рµ РїС–Рґ С„Р°РєС‚РёС‡РЅРёР№ СЃС‚Р°РЅ)
- **DAOвЂ‘Gallery СЂРµР»С–Р·Рё:** РІРёРїСЂР°РІРёС‚Рё РїРѕСЂРѕР¶РЅС– ZIPРё Сѓ `SYMBOLS/ANIM/BRAND` (РїРµСЂРµРІС–СЂРєР° dist С‚Р° СЂРµР»С–Р·вЂ‘assets).
- **Branch protection:** РґРѕР±РёС‚Рё РІРёРјРѕРіРё РґРѕ РїРµСЂРµРІС–СЂРѕРє Сѓ `checha_core` (СѓР·РіРѕРґРёС‚Рё required checks + РјС–РЅ. approvals).
- **РЎРєСЂРёРїС‚ СЂРµР»С–Р·вЂ‘РїРµСЂРµРІС–СЂРєРё:** РІРёРїСЂР°РІРёС‚Рё РїР°СЂР°РјРµС‚СЂРё Сѓ `check_release.ps1` (СѓР·РіРѕРґР¶РµРЅРЅСЏ РЅР°Р·РІ/РїР°СЂР°РјРµС‚СЂС–РІ).

---

## вљ пёЏ РўРµСЂРјС–РЅРѕРІС– Р·Р°РІРґР°РЅРЅСЏ (7 РґРЅС–РІ)
> SLA: РѕРЅРѕРІР»РµРЅРЅСЏ СЃС‚Р°С‚СѓСЃС–РІ С‰РѕРґРµРЅРЅРѕ.

- [ ] **G04вЂ‘TвЂ‘20250903вЂ‘U01** вЂ” РћРїСѓР±Р»С–РєСѓРІР°С‚Рё РїСѓР±Р»С–С‡РЅСѓ СЃС‚РѕСЂС–РЅРєСѓ `G04 вЂ” DAOвЂ‘РљРѕРѕСЂРґРёРЅР°С†С–СЏ` Сѓ GitBook (README, СЃС‚СЂСѓРєС‚СѓСЂР°, Р·РІвЂ™СЏР·РєРё) вЂ” **РґРµРґР»Р°Р№РЅ:** 2025вЂ‘09вЂ‘09 вЂ” **РЎС‚Р°С‚СѓСЃ:** Planned
- [ ] **G04вЂ‘TвЂ‘20250903вЂ‘U02** вЂ” РџСЂРёРІвЂ™СЏР·Р°С‚Рё РїР°РЅРµР»СЊ РґРѕ DAOвЂ‘Р–СѓСЂРЅР°Р»Сѓ (СЏРєРѕСЂС– С–РЅС–С†С–Р°С‚РёРІ/СЂС–С€РµРЅСЊ, РїРѕСЃРёР»Р°РЅРЅСЏ РЅР° Р°СЂС‚РµС„Р°РєС‚Рё) вЂ” **РґРµРґР»Р°Р№РЅ:** 2025вЂ‘09вЂ‘10 вЂ” **РЎС‚Р°С‚СѓСЃ:** Planned
- [ ] **G04вЂ‘TвЂ‘20250903вЂ‘U03** вЂ” РЈСЃСѓРЅСѓС‚Рё РґСѓР±Р»СЋРІР°РЅРЅСЏ С€Р»СЏС…С–РІ Сѓ С–РЅРґРµРєСЃС– C12/Protocols РїСЂРё СЃРёРЅС…СЂРѕРЅС–Р·Р°С†С–С— Р· MinIO вЂ” **РґРµРґР»Р°Р№РЅ:** 2025вЂ‘09вЂ‘08 вЂ” **РЎС‚Р°С‚СѓСЃ:** Planned

---

## рџџў РџР»Р°РЅРѕРІС– Р·Р°РІРґР°РЅРЅСЏ (30 РґРЅС–РІ)
> SLA: С‰РѕС‚РёР¶РЅРµРІРёР№ Р°РїРґРµР№С‚, РїРµСЂРµРІС–Рґ Сѓ В«РўРµСЂРјС–РЅРѕРІС–В» Р·Р° 7 РґРЅС–РІ РґРѕ РґРµРґР»Р°Р№РЅСѓ.

- [ ] **G04вЂ‘TвЂ‘20250903вЂ‘P01** вЂ” Р†РЅС‚РµРіСЂР°С†С–СЏ Р· G06 (Р°РІС‚РѕР·Р±С–СЂ Р·Р°РґР°С‡/Р·РІРµРґРµРЅСЊ С–Р· Р°РіРµРЅС‚С–РІ) вЂ” **РЎС‚Р°С‚СѓСЃ:** Planned
- [ ] **G04вЂ‘TвЂ‘20250903вЂ‘P02** вЂ” Р†РЅС‚РµРіСЂР°С†С–СЏ Р· G11 (СЂРѕР»СЊРѕРІС– РјР°РЅРґР°С‚Рё, РІС–РґРїРѕРІС–РґР°Р»СЊРЅС–СЃС‚СЊ, РїР°РЅРµР»СЊ Р»С–РґРµСЂС–РІ) вЂ” **РЎС‚Р°С‚СѓСЃ:** Planned
- [ ] **G04вЂ‘TвЂ‘20250903вЂ‘P03** вЂ” РЎС‚Р°Р±С–Р»С–Р·СѓРІР°С‚Рё `RHYTHM_DASHBOARD` С– РґРѕРґР°С‚Рё Р°РІС‚РѕРјР°С‚РёС‡РЅС– Р°Р»РµСЂС‚Рё (health) вЂ” **РЎС‚Р°С‚СѓСЃ:** Planned

---

## рџ“‘ РђРєС‚РёРІРЅС– РїСЂРѕС‚РѕРєРѕР»Рё
- рџ”— **Coordination Protocol 01** вЂ” `C12/Protocols/Coordination_01.md`
- рџ”— **Coordination Protocol 02** вЂ” `C12/Protocols/Coordination_02.md`

> **РќР°РіР°РґСѓРІР°РЅРЅСЏ:** СѓСЃС– РїСЂРѕС‚РѕРєРѕР»Рё РјР°СЋС‚СЊ РІРµСЂСЃС–СЋ, РІР»Р°СЃРЅРёРєР°, Р¶СѓСЂРЅР°Р» Р·РјС–РЅ С‚Р° РїСЂРёРІвЂ™СЏР·РєСѓ РґРѕ GвЂ‘РјРѕРґСѓР»С–РІ.

---

## рџ“Љ РћСЃС‚Р°РЅРЅС– Р·РІС–С‚Рё
- рџ“… **Р©РѕС‚РёР¶РЅРµРІРёР№ Р·РІС–С‚** вЂ” `Reports.md#week-2025-W36`
- рџ“… **Р©РѕРјС–СЃСЏС‡РЅРёР№ Р·РІС–С‚** вЂ” `Reports.md#month-2025-09`

---

## рџ“‚ DAOвЂ‘Р–СѓСЂРЅР°Р»
- рџ”— РџРµСЂРµР№С‚Рё РґРѕ `DAOвЂ‘JOURNAL` (СЂРµС”СЃС‚СЂ С–РЅС–С†С–Р°С‚РёРІ/СЂС–С€РµРЅСЊ, СЃС‚Р°С‚СѓСЃРё, РІРёРєРѕРЅР°РІС†С–, РїРѕСЃРёР»Р°РЅРЅСЏ РЅР° Р°СЂС‚РµС„Р°РєС‚Рё).

---

## рџ“‘ РЁРІРёРґРєС– С€Р°Р±Р»РѕРЅРё (BTD 1.0)
- рџ“ `templates/TEMPLATE_DAO-GXX.md`
- рџ“ `templates/README_TEMPLATE.md`
- рџ“ `templates/STRUCTURE_TEMPLATE.md`
- рџ“ `templates/INSTRUCTIONS_TEMPLATE.md`

---

## рџ”— Р†РЅС‚РµРіСЂР°С†С–С— G04
- рџ¤– **G06 вЂ” РђРіРµРЅС‚РЅР° РјРѕРґРµР»СЊ:** Р°РІС‚РѕР·Р±С–СЂ Р·Р°РІРґР°РЅСЊ/Р·РІРµРґРµРЅСЊ, С–РЅС‚РµРіСЂР°С†С–СЏ Р· GPTвЂ‘Р°РіРµРЅС‚Р°РјРё.
- рџ“° **G09 вЂ” РњРµРґС–Р°вЂ‘РђР»СЊСЏРЅСЃ:** РїС–РґРіРѕС‚РѕРІРєР° Р№ СѓР·РіРѕРґР¶РµРЅРЅСЏ Р·РѕРІРЅС–С€РЅС–С… РєРѕРјСѓРЅС–РєР°С†С–Р№.
- рџ§­ **G11 вЂ” Р›С–РґРµСЂСЃС‚РІРѕ:** СѓР·РіРѕРґР¶РµРЅРЅСЏ СЂРѕР»РµР№, РјР°РЅРґР°С‚С–РІ, РІС–РґРїРѕРІС–РґР°Р»СЊРЅРѕСЃС‚С–.

---

## рџ“Ў Р РёС‚РјРё С‚Р° SLA
- **Daily:** РєРѕСЂРѕС‚РєРёР№ Р°РїРґРµР№С‚ РєСЂРёС‚РёС‡РЅРёС…/С‚РµСЂРјС–РЅРѕРІРёС… (СЂР°РЅРѕРє/РІРµС‡С–СЂ).
- **Weekly (РќРґ):** РєРѕРЅСЃРѕР»С–РґРѕРІР°РЅРёР№ G04вЂ‘Р·РІС–С‚ (РІС…РѕРґРёС‚СЊ Сѓ Р·Р°РіР°Р»СЊРЅРёР№ РґР°Р№РґР¶РµСЃС‚).
- **Monthly (1 С‡РёСЃР»Рѕ):** СЂРµС‚СЂРѕСЃРїРµРєС‚РёРІР° + РїР»Р°РЅ РЅР° РјС–СЃСЏС†СЊ.

---

## рџ—‚пёЏ РЎС‚СЂСѓРєС‚СѓСЂР° С„Р°Р№Р»С–РІ (СЂРµРєРѕРјРµРЅРґР°С†С–СЏ)
```
C06_FOCUS/                     # Р РѕР±РѕС‡С– РїР°РЅРµР»С– С‚Р° С„РѕРєСѓСЃРё
  G04_PANEL.md                # Р¦РµР№ С„Р°Р№Р» (РґР¶РµСЂРµР»Рѕ РїСЂР°РІРґРё РїРѕ G04)
  _data/g04_tasks.json        # РњР°С€РёРЅРѕС‡РёС‚РЅРёР№ СЂРµС”СЃС‚СЂ Р·Р°РІРґР°РЅСЊ
  _data/g04_protocols.json    # Р†РЅРґРµРєСЃ Р°РєС‚РёРІРЅРёС… РїСЂРѕС‚РѕРєРѕР»С–РІ
C11_AUTOMATION/
  G04/Update-G04-Panel.ps1    # Р РµРЅРґРµСЂ/СЃРёРЅС…СЂРѕРЅС–Р·Р°С†С–СЏ РїР°РЅРµР»С– Р· _data С‚Р° Р¶СѓСЂРЅР°Р»Р°РјРё
C03/LOG/
  G04_PANEL_HISTORY.md        # Р†СЃС‚РѕСЂС–СЏ Р·РјС–РЅ РїР°РЅРµР»С– С‚Р° РєР»СЋС‡РѕРІС– РїРѕРґС–С—
DAO-G/G04/
  README.md                   # РџСѓР±Р»С–С‡РЅР° СЃС‚РѕСЂС–РЅРєР° РјРѕРґСѓР»СЏ (GitBook/Journey)
```

---

## рџ§© Р¤РѕСЂРјР°С‚Рё РґР°РЅРёС… (РјР°С€РёРЅРѕС‡РёС‚РЅС– РїСЂРёРєР»Р°РґРё)
**`_data/g04_tasks.json`**
```json
{
  "critical_48h": [
    {"id": "G04-T-20250903-C01", "title": "вЂ¦", "owner": "вЂ¦", "eta": "2025-09-04T18:00:00+03:00", "status": "Pending", "notes": "вЂ¦"}
  ],
  "urgent_7d": [
    {"id": "G04-T-20250903-U01", "title": "вЂ¦", "deadline": "2025-09-09", "status": "Pending"}
  ],
  "planned_30d": [
    {"id": "G04-T-20250903-P01", "title": "вЂ¦", "status": "Planned"}
  ]
}
```

**`_data/g04_protocols.json`**
```json
{
  "items": [
    {"id": "CP-01", "title": "Coordination Protocol 01", "path": "C12/Protocols/Coordination_01.md", "version": "v1.0"},
    {"id": "CP-02", "title": "Coordination Protocol 02", "path": "C12/Protocols/Coordination_02.md", "version": "v1.0"}
  ]
}
```

---

## вљ™пёЏ РЎРєСЂРёРїС‚ СЂРµРЅРґРµСЂСѓ РїР°РЅРµР»С– (РїРѕРІРЅР° РІРµСЂСЃС–СЏ)
> Р‘РµСЂРµ `_data/*.json`, РґРѕРґР°С” Р°РІС‚РѕСЏРєРѕСЂС– Р·РІС–С‚С–РІ (week/month), РІРёС‚СЏРіСѓС” РґР°Р№РґР¶РµСЃС‚ С–Р· РѕСЃС‚Р°РЅРЅС–С… Р»РѕРіС–РІ, Р·Р±РёСЂР°С” Markdown С– РІРµРґРµ С–СЃС‚РѕСЂС–СЋ РѕРЅРѕРІР»РµРЅСЊ.

```powershell
[CmdletBinding()]
param(
  [string]$Root = "C:\CHECHA_CORE",
  [string]$PanelMd = $(Join-Path "C:\CHECHA_CORE" "C06_FOCUS\G04_PANEL.md"),
  [string]$DataDir = $(Join-Path "C:\CHECHA_CORE" "C06_FOCUS\_data"),
  [string]$LogDir  = $(Join-Path "C:\CHECHA_CORE" "C03\LOG"),
  [string]$HistoryMd = $(Join-Path "C:\CHECHA_CORE" "C03\LOG\G04_PANEL_HISTORY.md"),
  [string]$JournalPath = $(Join-Path "C:\CHECHA_CORE" "DAO-JOURNAL\README.md"),
  [switch]$DryRun
)

function Ensure-Dir([string]$p){ if(-not (Test-Path $p)){ New-Item -ItemType Directory -Force -Path $p | Out-Null } }
function Read-Json([string]$p){ if(Test-Path $p){ try{ Get-Content $p -Raw -Encoding UTF8 | ConvertFrom-Json } catch{ Write-Warning "JSON parse error: $p вЂ” $_"; $null } } else { $null } }
function NowKyiv(){ (Get-Date).ToString('yyyy-MM-dd HH:mm:ss') }
function IsoWeekInfo(){
  $now = Get-Date
  $w = [System.Globalization.ISOWeek]::GetWeekOfYear($now)
  $wk = [string]::Format('{0:D2}',$w)
  @{ Year=$now.Year; Week=$wk; Month=$now.ToString('yyyy-MM') }
}

# Paths
Ensure-Dir (Split-Path $PanelMd -Parent)
Ensure-Dir $DataDir
Ensure-Dir (Split-Path $HistoryMd -Parent)

# Load data
$tasksPath = Join-Path $DataDir 'g04_tasks.json'
$protoPath = Join-Path $DataDir 'g04_protocols.json'
$T = Read-Json $tasksPath
$P = Read-Json $protoPath
if(-not $T){ $T = @{ critical_48h=@(); urgent_7d=@(); planned_30d=@() } }
if(-not $P){ $P = @{ items=@() } }

# Compute anchors (reports)
$wi = IsoWeekInfo
$weeklyAnchor  = "Reports.md#week-$($wi.Year)-W$($wi.Week)"
$monthlyAnchor = "Reports.md#month-$($wi.Month)"

# Logs digest (last 3 logs, 200 lines; error/warn counters)
$logFiles = Get-ChildItem -Path $LogDir -Filter '*.log' -File -ErrorAction SilentlyContinue | Sort-Object LastWriteTime -Descending | Select-Object -First 3
$errCount=0;$warnCount=0;$lastErrLine=$null
foreach($lf in $logFiles){
  $lines = Get-Content $lf -Tail 200 -ErrorAction SilentlyContinue
  foreach($ln in $lines){
    if($ln -match '(?i)(ERROR|ERR|FAILED|EXCEPTION)'){ $errCount++; $lastErrLine=$ln }
    if($ln -match '(?i)(WARNING|WARN)'){ $warnCount++ }
  }
}

# Markdown build helpers
function Section-Tasks($title,$arr,$fmt){
  $s = @()
  $s += "## $title"
  if($null -eq $arr -or $arr.Count -eq 0){ $s += "- (РїРѕСЂРѕР¶РЅСЊРѕ)"; return ($s -join "`n") }
  foreach($t in $arr){
    $id=$t.id; $title=$t.title; $owner=$t.owner; $eta=$t.eta; $status=$t.status; $deadline=$t.deadline
    switch($fmt){
      'critical' { $s += "- [ ] **$id** вЂ” $title вЂ” **РІС–РґРїРѕРІС–РґР°Р»СЊРЅРёР№:** $owner вЂ” **ETA:** $eta вЂ” **РЎС‚Р°С‚СѓСЃ:** $status" }
      'urgent'   { $s += "- [ ] **$id** вЂ” $title вЂ” **РґРµРґР»Р°Р№РЅ:** $deadline вЂ” **РЎС‚Р°С‚СѓСЃ:** $status" }
      'planned'  { $s += "- [ ] **$id** вЂ” $title вЂ” **РЎС‚Р°С‚СѓСЃ:** $status" }
    }
  }
  return ($s -join "`n")
}

function Section-Protocols($items){
  $s=@(); $s+="## рџ“‘ РђРєС‚РёРІРЅС– РїСЂРѕС‚РѕРєРѕР»Рё"
  if($null -eq $items -or $items.Count -eq 0){ $s += "- (РїРѕСЂРѕР¶РЅСЊРѕ)"; return ($s -join "`n") }
  foreach($p in $items){ $s += "- рџ”— **$($p.title)** вЂ” `$($p.path)` (v$($p.version))" }
  ($s -join "`n")
}

# Header
$now = NowKyiv
$md = @()
$md += "# G04 вЂ” Р РѕР±РѕС‡Р° РџР°РЅРµР»СЊ (MVP v1.0)"
$md += "**РЎС‚Р°С‚СѓСЃ:** ACTIVE вЂў **РћРЅРѕРІР»РµРЅРѕ:** $now (Kyiv)"
$md += "
---
"

# Tasks sections
$md += (Section-Tasks 'рџљЁ РљСЂРёС‚РёС‡РЅС– Р·Р°РІРґР°РЅРЅСЏ (48 РіРѕРґ)' $T.critical_48h 'critical')
$md += "
---
"
$md += (Section-Tasks 'вљ пёЏ РўРµСЂРјС–РЅРѕРІС– Р·Р°РІРґР°РЅРЅСЏ (7 РґРЅС–РІ)' $T.urgent_7d 'urgent')
$md += "
---
"
$md += (Section-Tasks 'рџџў РџР»Р°РЅРѕРІС– Р·Р°РІРґР°РЅРЅСЏ (30 РґРЅС–РІ)' $T.planned_30d 'planned')
$md += "
---
"

# Protocols
$md += (Section-Protocols $P.items)
$md += "
---
"

# Reports anchors
$md += "## рџ“Љ РћСЃС‚Р°РЅРЅС– Р·РІС–С‚Рё"
$md += "- рџ“… **Р©РѕС‚РёР¶РЅРµРІРёР№ Р·РІС–С‚** вЂ” `$weeklyAnchor`"
$md += "- рџ“… **Р©РѕРјС–СЃСЏС‡РЅРёР№ Р·РІС–С‚** вЂ” `$monthlyAnchor`"
$md += "
---
"

# Journal link
$journalLink = if(Test-Path $JournalPath){ $JournalPath } else { 'DAOвЂ‘JOURNAL (README.md)' }
$md += "## рџ“‚ DAOвЂ‘Р–СѓСЂРЅР°Р»"
$md += "- рџ”— РџРµСЂРµР№С‚Рё РґРѕ: `$journalLink`"
$md += "
---
"

# Templates & Integrations (static refs kept)
$md += "## рџ“‘ РЁРІРёРґРєС– С€Р°Р±Р»РѕРЅРё (BTD 1.0)"
$md += "- рџ“ `templates/TEMPLATE_DAO-GXX.md`"
$md += "- рџ“ `templates/README_TEMPLATE.md`"
$md += "- рџ“ `templates/STRUCTURE_TEMPLATE.md`"
$md += "- рџ“ `templates/INSTRUCTIONS_TEMPLATE.md`"
$md += "
---
"
$md += "## рџ”— Р†РЅС‚РµРіСЂР°С†С–С— G04"
$md += "- рџ¤– **G06 вЂ” РђРіРµРЅС‚РЅР° РјРѕРґРµР»СЊ:** Р°РІС‚РѕР·Р±С–СЂ Р·Р°РІРґР°РЅСЊ/Р·РІРµРґРµРЅСЊ, С–РЅС‚РµРіСЂР°С†С–СЏ Р· GPTвЂ‘Р°РіРµРЅС‚Р°РјРё."
$md += "- рџ“° **G09 вЂ” РњРµРґС–Р°вЂ‘РђР»СЊСЏРЅСЃ:** РїС–РґРіРѕС‚РѕРІРєР° Р№ СѓР·РіРѕРґР¶РµРЅРЅСЏ Р·РѕРІРЅС–С€РЅС–С… РєРѕРјСѓРЅС–РєР°С†С–Р№."
$md += "- рџ§­ **G11 вЂ” Р›С–РґРµСЂСЃС‚РІРѕ:** СѓР·РіРѕРґР¶РµРЅРЅСЏ СЂРѕР»РµР№, РјР°РЅРґР°С‚С–РІ, РІС–РґРїРѕРІС–РґР°Р»СЊРЅРѕСЃС‚С–."
$md += "
---
"

# Logs digest section
$md += "## рџ§Є Р›РѕРіРё (РѕСЃС‚Р°РЅРЅС– 3 С„Р°Р№Р»Рё, РґР°Р№РґР¶РµСЃС‚)"
$md += "- Р—РЅР°Р№РґРµРЅРѕ: $($logFiles.Count) С„Р°Р№Р»С–РІ; **ERR:** $errCount вЂў **WARN:** $warnCount"
if($lastErrLine){ $md += ("- РћСЃС‚Р°РЅРЅСЏ РїРѕРјРёР»РєР°: " + ($lastErrLine -replace '\|`','').Trim()) }

# Output
$final = ($md -join "`n") + "`n"
if($DryRun){
  Write-Host "[DryRun] Would write panel to: $PanelMd" -ForegroundColor Yellow
} else {
  $final | Set-Content -Encoding UTF8 $PanelMd
  Write-Host "вњ… РћРЅРѕРІР»РµРЅРѕ РїР°РЅРµР»СЊ: $PanelMd"
}

# History entry
$h = @()
$h += "[${now}] Update: critical=$($T.critical_48h.Count); urgent=$($T.urgent_7d.Count); planned=$($T.planned_30d.Count); ERR=$errCount; WARN=$warnCount"
Add-Content -Encoding UTF8 -Path $HistoryMd -Value ($h -join "`n")
Write-Host "рџ“ќ Р”РѕРґР°РЅРѕ Р·Р°РїРёСЃ Сѓ С–СЃС‚РѕСЂС–СЋ: $HistoryMd"
```


---

## рџљЂ РђРєС‚РёРІР°С†С–СЏ (15 С…РІ)
1) **РЎС‚РІРѕСЂРёС‚Рё СЃС‚СЂСѓРєС‚СѓСЂСѓ** РїР°РїРѕРє/С„Р°Р№Р»С–РІ (РґРёРІ. РІРёС‰Рµ).
2) **РЎРєРѕРїС–СЋРІР°С‚Рё С†РµР№ С„Р°Р№Р»** Сѓ `C06_FOCUS/G04_PANEL.md` С‚Р° Р·Р°РєРѕРјС–С‚РёС‚Рё Сѓ `checha_core`.
3) **Р—Р°РїРѕРІРЅРёС‚Рё _data** (`g04_tasks.json`, `g04_protocols.json`) РїРµСЂС€РёРјРё Р·Р°РїРёСЃР°РјРё.
4) **Р—Р°РїСѓСЃС‚РёС‚Рё СЃРєСЂРёРїС‚** `C11_AUTOMATION/G04/Update-G04-Panel.ps1` РІСЂСѓС‡РЅСѓ.
5) (РћРїС†.) **Р РѕР·РєР»Р°Рґ Р·Р°РІРґР°РЅРЅСЏ** Windows Scheduler:
```
schtasks /Create /TN "G04_UpdatePanel" /SC HOURLY /MO 4 ^
 /TR "pwsh -NoProfile -ExecutionPolicy Bypass -File C:\CHECHA_CORE\C11\C11_AUTOMATION\G04\Update-G04-Panel.ps1" ^
 /ST 08:00 /RU SYSTEM
```

---

## рџЏ·пёЏ РџСЂР°РІРёР»Р° С–РґРµРЅС‚РёС„С–РєР°С†С–С— Р·Р°РІРґР°РЅСЊ
`G04-T-<YYYYMMDD>-<C|U|P><NN>`
- `C` вЂ” Critical 48h, `U` вЂ” Urgent 7d, `P` вЂ” Planned 30d.
- РџСЂРё Р·РјС–РЅС– РїСЂС–РѕСЂРёС‚РµС‚Сѓ: РїРµСЂРµРЅРѕСЃРёРјРѕ РјС–Р¶ СЂРѕР·РґС–Р»Р°РјРё, **ID РЅРµ Р·РјС–РЅСЋС”С‚СЊСЃСЏ**.

---

## рџ§­ Р РѕР»С– С‚Р° РІС–РґРїРѕРІС–РґР°Р»СЊРЅС–СЃС‚СЊ
- **G04вЂ‘Coordinator:** Р·Р°С‚РІРµСЂРґР¶СѓС” РїСЂС–РѕСЂРёС‚РµС‚Рё, РІРµРґРµ СЂРёС‚РјРё, РїСЂРёР№РјР°С” РµСЃРєР°Р»Р°С†С–С—.
- **Secretary:** РїС–РґС‚СЂРёРјСѓС” Р°РєС‚СѓР°Р»СЊРЅС–СЃС‚СЊ РїР°РЅРµР»С–/Р¶СѓСЂРЅР°Р»Сѓ, РєРѕРЅС‚СЂРѕР»СЋС” SLA РѕРЅРѕРІР»РµРЅСЊ.
- **Analyst:** Р·РІРѕРґРёС‚СЊ РјРµС‚СЂРёРєРё, РіРѕС‚СѓС” С‚РёР¶РЅРµРІС–/РјС–СЃСЏС‡РЅС– Р·СЂС–Р·Рё, РІРёСЏРІР»СЏС” СЂРёР·РёРєРё.
- **OnвЂ‘duty:** С‡РµСЂРіРѕРІРёР№ РЅР° РєСЂРёС‚РёС‡РЅС– Р·РІРµСЂРЅРµРЅРЅСЏ Сѓ РІС–РєРЅС– 48 РіРѕРґ.

---

# рџ“¦ ZIPвЂ‘РїР°РєРµС‚ `G04_AUTOMATION_v1.1`
**РџСЂРёР·РЅР°С‡РµРЅРЅСЏ:** Р·С–Р±СЂР°С‚Рё РІСЃС– СЃРєСЂРёРїС‚Рё/С€Р°Р±Р»РѕРЅРё G04 РІ РѕРґРёРЅ Р°СЂС…С–РІ РґР»СЏ РІСЃС‚Р°РЅРѕРІР»РµРЅРЅСЏ РЅР° С–РЅС€РёР№ РІСѓР·РѕР» Р°Р±Рѕ РїСѓР±Р»С–РєР°С†С–С— Сѓ Release.

## Р’РјС–СЃС‚ РїР°РєРµС‚Р° (СЂРµРєРѕРјРµРЅРґРѕРІР°РЅРёР№)
```
C11_AUTOMATION/ G04/
  Update-G04-Panel.ps1
  Generate-G04-Tasks.ps1
  Invoke-G04-Health.ps1
  Handle-G04-Escalation.ps1
  Notify-G04.ps1
  Build-G04-Stats.ps1
  Pack-G04-Automation.ps1           # (С†РµР№ Р·Р±РёСЂР°С‡)
C06_FOCUS/
  G04_PANEL.md                       # СЃС‚Р°СЂС‚РѕРІР° РїР°РЅРµР»СЊ (РјРѕР¶РЅР° РїРµСЂРµР·Р°РїРёСЃР°С‚Рё РїСЂРё РѕРЅРѕРІР»РµРЅРЅС–)
  _data/
    g04_tasks.json                   # С‡РµСЂРЅРµС‚РєР°
    g04_protocols.json               # С‡РµСЂРЅРµС‚РєР°
    g04_notify.json                  # РїСЂРёРєР»Р°Рґ РєРѕРЅС„С–РіС–РІ РЅРѕС‚РёС„С–РєР°С†С–Р№
README_G04_AUTOMATION.md             # С–РЅСЃС‚СЂСѓРєС†С–С— РІСЃС‚Р°РЅРѕРІР»РµРЅРЅСЏ/СЂРёС‚РјС–РІ
RELEASE_NOTES.md                     # РЅРѕС‚Р°С‚РєРё СЂРµР»С–Р·Сѓ
MANIFEST.json                        # СЃРїРёСЃРѕРє С„Р°Р№Р»С–РІ, СЂРѕР·РјС–СЂРё, sha256
CHECKSUMS.txt                        # sha256 СѓСЃС–С… С„Р°Р№Р»С–РІ РїР°РєРµС‚Р°
```

> `g04_stats.json` РіРµРЅРµСЂСѓС”С‚СЊСЃСЏ РїС–Рґ С‡Р°СЃ СЂРѕР±РѕС‚Рё С– РґРѕ РїР°РєРµС‚Р° РЅРµ РІС…РѕРґРёС‚СЊ.

---

## README_G04_AUTOMATION.md (РІРјС–СЃС‚)
```
# G04 Automation v1.1
## РњРµС‚Р°
РђРІС‚РѕРјР°С‚РёР·Р°С†С–СЏ СЂРѕР±РѕС‡РѕС— РїР°РЅРµР»С– G04: РіРµРЅРµСЂР°С†С–СЏ Р·Р°РґР°С‡, СЂРµРЅРґРµСЂ РїР°РЅРµР»С–, healthвЂ‘check, РµСЃРєР°Р»Р°С†С–СЏ, РЅРѕС‚РёС„С–РєР°С†С–С—, СЃС‚Р°С‚РёСЃС‚РёРєР°.

## Р’СЃС‚Р°РЅРѕРІР»РµРЅРЅСЏ (Windows, PowerShell 7+)
1) Р РѕР·РїР°РєСѓР№С‚Рµ Р°СЂС…С–РІ Сѓ РєРѕСЂС–РЅСЊ `C:/CHECHA_CORE` (Р· РїС–РґС‚РІРµСЂРґР¶РµРЅРЅСЏРј Р·Р°РјС–РЅРё Р·Р° РїРѕС‚СЂРµР±Рё).
2) РџРµСЂРµРІС–СЂС‚Рµ СЃС‚СЂСѓРєС‚СѓСЂСѓ: `C11_AUTOMATION/G04/*.ps1`, `C06_FOCUS/G04_PANEL.md`, `_data/*.json`.
3) Р†РЅС–С†С–Р°Р»С–Р·СѓР№С‚Рµ СЃРµРєСЂРµС‚Рё (Telegram/Email) Р°Р±Рѕ РІС–РґСЂРµРґР°РіСѓР№С‚Рµ `_data/g04_notify.json`.
4) Р СѓС‡РЅРёР№ Р·Р°РїСѓСЃРє Сѓ С‚Р°РєРѕРјСѓ РїРѕСЂСЏРґРєСѓ:
   - `Generate-G04-Tasks.ps1` в†’ `Update-G04-Panel.ps1` в†’ `Invoke-G04-Health.ps1`.
5) РќР°Р»Р°С€С‚СѓР№С‚Рµ СЂРѕР·РєР»Р°Рґ (`schtasks`):
   - 08:15 вЂ” Generate
   - 08:18 вЂ” BuildвЂ‘Stats
   - 08:20 вЂ” UpdateвЂ‘Panel
   - 08:25 вЂ” HealthвЂ‘Escalate

## РћРЅРѕРІР»РµРЅРЅСЏ
- Р—Р°РјС–РЅСЋР№С‚Рµ Р»РёС€Рµ `C11_AUTOMATION/G04/*.ps1` С‚Р° С€Р°Р±Р»РѕРЅРё РІ `_data` (СЂСѓС‡РЅС– РїСЂР°РІРєРё Р·Р±РµСЂРµР¶С–С‚СЊ). 

## Р‘РµР·РїРµРєР°
- РЎРµРєСЂРµС‚Рё С‡РµСЂРµР· env: `G04_TG_BOT`, `G04_TG_CHAT`, `G04_SMTP_USER`, `G04_SMTP_PASS`.
- Р›РѕРіРё: `C03/LOG/G04_*` (РѕС‡РёС‰РµРЅРЅСЏ Р·Р° РІР°С€РёРјРё РїРѕР»С–С‚РёРєР°РјРё).
```

---

## RELEASE_NOTES.md (С€Р°Р±Р»РѕРЅ)
```
# G04 Automation v1.1 вЂ” 2025вЂ‘09вЂ‘03
- Р”РѕРґР°РЅРѕ РїРѕРІРЅРёР№ СЂРµРЅРґРµСЂ РїР°РЅРµР»С– Р· РґР°Р№РґР¶РµСЃС‚РѕРј Р»РѕРіС–РІ.
- РђРІС‚РѕРіРµРЅРµСЂР°С‚РѕСЂ Р·Р°РґР°С‡ С–Р· git/Р»РѕРіС–РІ.
- HealthвЂ‘check + Escalation (cooldown, Р»РѕРіСѓРІР°РЅРЅСЏ, СЃС‚РІРѕСЂРµРЅРЅСЏ РєСЂРёС‚РёС‡РЅРёС… Р·Р°РґР°С‡).
- РќРѕС‚РёС„С–РєР°С†С–С— (Telegram/Email) + СЃС‚Р°С‚РёСЃС‚РёРєР° РµСЃРєР°Р»Р°С†С–Р№.
- РџР°РєСѓРІР°Р»СЊРЅРёРє Р· MANIFEST С– CHECKSUMS.
```

---

## `Pack-G04-Automation.ps1` вЂ” Р·Р±С–СЂРєР° ZIP + MANIFEST + CHECKSUMS
```powershell
[CmdletBinding()]
param(
  [string]$Root = 'C:/CHECHA_CORE',
  [string]$Version = 'v1.1',
  [string]$OutDir = $(Join-Path $PWD 'dist'),
  [switch]$OpenFolder
)

function Ensure-Dir($p){ if(-not (Test-Path $p)){ New-Item -ItemType Directory -Force -Path $p | Out-Null } }
function Sha256($p){ (Get-FileHash -Algorithm SHA256 -Path $p).Hash.ToLower() }

$stamp = (Get-Date).ToString('yyyyMMdd_HHmmss')
$zipName = "G04_AUTOMATION_${Version}_${stamp}.zip"
$stage = Join-Path $env:TEMP ("g04_stage_"+$stamp)
Ensure-Dir $stage
Ensure-Dir $OutDir

# РЎРїРёСЃРѕРє С„Р°Р№Р»С–РІ (РІС–РґРЅРѕСЃРЅРѕ $Root)
$files = @(
  'C11/C11_AUTOMATION/G04/Update-G04-Panel.ps1',
  'C11/C11_AUTOMATION/G04/Generate-G04-Tasks.ps1',
  'C11/C11_AUTOMATION/G04/Invoke-G04-Health.ps1',
  'C11/C11_AUTOMATION/G04/Handle-G04-Escalation.ps1',
  'C11/C11_AUTOMATION/G04/Notify-G04.ps1',
  'C11/C11_AUTOMATION/G04/Build-G04-Stats.ps1',
  'C11/C11_AUTOMATION/G04/Pack-G04-Automation.ps1',
  'C06_FOCUS/G04_PANEL.md',
  'C06_FOCUS/_data/g04_tasks.json',
  'C06_FOCUS/_data/g04_protocols.json',
  'C06_FOCUS/_data/g04_notify.json',
  'README_G04_AUTOMATION.md',
  'RELEASE_NOTES.md'
)

# РљРѕРїС–СЋРІР°РЅРЅСЏ Сѓ stage
foreach($rel in $files){
  $src = Join-Path $Root $rel
  if(-not (Test-Path $src)) { Write-Warning "Skip missing: $rel"; continue }
  $dst = Join-Path $stage $rel
  Ensure-Dir (Split-Path $dst -Parent)
  Copy-Item $src $dst -Force
}

# MANIFEST.json
$manifest = @()
Get-ChildItem -Path $stage -Recurse -File | ForEach-Object {
  $rel = [IO.Path]::GetRelativePath($stage, $_.FullName).Replace([IO.Path]::DirectorySeparatorChar, '/')
  $manifest += [ordered]@{ path=$rel; size=$_.Length; sha256=Sha256 $_.FullName }
}
$manifestPath = Join-Path $stage 'MANIFEST.json'
$manifest | ConvertTo-Json -Depth 5 | Set-Content -Encoding UTF8 $manifestPath

# CHECKSUMS.txt (РґР»СЏ РєРѕСЂРµРЅСЏ РїР°РєРµС‚Р°)
$checks = @()
Get-ChildItem -Path $stage -Recurse -File | ForEach-Object {
  $rel = [IO.Path]::GetRelativePath($stage, $_.FullName).Replace([IO.Path]::DirectorySeparatorChar, '/')
  $checks += ("{0} *{1}" -f (Sha256 $_.FullName), $rel)
}
$checksPath = Join-Path $stage 'CHECKSUMS.txt'
$checks -join "`n" | Set-Content -Encoding ASCII $checksPath

# ZIP
$zipPath = Join-Path $OutDir $zipName
if(Test-Path $zipPath){ Remove-Item $zipPath -Force }
Compress-Archive -Path (Join-Path $stage '*') -DestinationPath $zipPath -CompressionLevel Optimal

Write-Host "вњ… Р—С–Р±СЂР°РЅРѕ: $zipPath"
if($OpenFolder){ ii $OutDir }
```

**Р—Р°РїСѓСЃРє:**
```
pwsh -NoProfile -ExecutionPolicy Bypass -File C:/CHECHA_CORE/C11/C11_AUTOMATION/G04/Pack-G04-Automation.ps1 -Root C:/CHECHA_CORE -Version v1.1 -OutDir C:/CHECHA_CORE/C05_ARCHIVE -OpenFolder
```

---

## РџСѓР±Р»С–РєР°С†С–СЏ Сѓ GitHub Release (РѕРїС†С–Р№РЅРѕ)
> РџРѕС‚СЂРµР±СѓС” `gh` CLI С– РґРѕСЃС‚СѓРїСѓ РґРѕ СЂРµРїРѕР·РёС‚РѕСЂС–СЋ `Checha-hub-DAO/checha_core`.
```
$repo = 'Checha-hub-DAO/checha_core'
$tag  = 'g04-automation-v1.1'
$zip  = (Get-ChildItem C:/CHECHA_CORE/C05_ARCHIVE -Filter 'G04_AUTOMATION_v1.1_*.zip' | Sort-Object LastWriteTime -Desc | Select-Object -First 1).FullName

# РЎС‚РІРѕСЂРёС‚Рё Р°Р±Рѕ РѕРЅРѕРІРёС‚Рё СЂРµР»С–Р·
cd C:/CHECHA_CORE
$notes = Get-Content ./RELEASE_NOTES.md -Raw

gh release create $tag $zip -R $repo -t 'G04 Automation v1.1' -n $notes
# Р°Р±Рѕ (РѕРЅРѕРІРёС‚Рё С–СЃРЅСѓСЋС‡РёР№):
# gh release upload $tag $zip --clobber -R $repo
```

## рџ“ќ Changelog
- **2025вЂ‘09вЂ‘03 (v1.0):** РЎС‚Р°СЂС‚РѕРІР° РІРµСЂСЃС–СЏ РїР°РЅРµР»С–, СЃС‚СЂСѓРєС‚СѓСЂРё _data, СЃРєРµР»РµС‚ СЃРєСЂРёРїС‚Р° СЂРµРЅРґРµСЂСѓ, СЂРёС‚РјРё/SLA, С–РЅС‚РµРіСЂР°С†С–С—.


---

## рџ“¦ _data вЂ” Р§РµСЂРЅРµС‚РєР° v1.0 (РіРѕС‚РѕРІС– JSON)

**`_data/g04_tasks.json`**
```json
{
  "critical_48h": [
    {
      "id": "G04-T-20250903-C01",
      "title": "Р’РёРїСЂР°РІРёС‚Рё РїРѕСЂРѕР¶РЅС– ZIP Сѓ СЂРµР»С–Р·Р°С… DAO-Gallery (SYMBOLS/ANIM/BRAND); РїРµСЂРµРІС–СЂРёС‚Рё dist С– Release assets",
      "owner": "РЎ.Р§.",
      "eta": "2025-09-04T18:00:00+03:00",
      "status": "In-Progress",
      "notes": "Р”РёРІ. Р»РѕРіРё 2025-09-02 (DAO-Gallery)"
    },
    {
      "id": "G04-T-20250903-C02",
      "title": "Р—Р°РІРµСЂС€РёС‚Рё branch protection Сѓ Checha-hub-DAO/checha_core (required checks, min approvals)",
      "owner": "РЎ.Р§.",
      "eta": "2025-09-04T20:00:00+03:00",
      "status": "In-Progress",
      "notes": "0902T08 CI/CD"
    },
    {
      "id": "G04-T-20250903-C03",
      "title": "Р’РёРїСЂР°РІРёС‚Рё РїР°СЂР°РјРµС‚СЂРё РІ tools/check_release.ps1 (СѓР·РіРѕРґРёС‚Рё РЅР°Р·РІРё/РїР°СЂР°РјРµС‚СЂРё; С‚РµСЃС‚ С–Р· ethno-v1.2)",
      "owner": "РЎ.Р§.",
      "eta": "2025-09-05T12:00:00+03:00",
      "status": "Pending",
      "notes": "РџРѕРјРёР»РєР° РїР°СЂР°РјРµС‚СЂР° -ZipName"
    }
  ],
  "urgent_7d": [
    {
      "id": "G04-T-20250903-U01",
      "title": "РћРїСѓР±Р»С–РєСѓРІР°С‚Рё G04 Сѓ GitBook (README, СЃС‚СЂСѓРєС‚СѓСЂР°, Р·РІвЂ™СЏР·РєРё)",
      "deadline": "2025-09-09",
      "status": "Planned"
    },
    {
      "id": "G04-T-20250903-U02",
      "title": "РџСЂРёРІвЂ™СЏР·Р°С‚Рё РїР°РЅРµР»СЊ РґРѕ DAO-Р–СѓСЂРЅР°Р»Сѓ (СЏРєРѕСЂС– С–РЅС–С†С–Р°С‚РёРІ/СЂС–С€РµРЅСЊ)",
      "deadline": "2025-09-10",
      "status": "Planned"
    },
    {
      "id": "G04-T-20250903-U03",
      "title": "РЈСЃСѓРЅСѓС‚Рё РґСѓР±Р»СЋРІР°РЅРЅСЏ С€Р»СЏС…С–РІ Сѓ C12/Protocols РїСЂРё СЃРёРЅС…СЂРѕРЅС–Р·Р°С†С–С— Р· MinIO",
      "deadline": "2025-09-08",
      "status": "Planned"
    }
  ],
  "planned_30d": [
    {
      "id": "G04-T-20250903-P01",
      "title": "Р†РЅС‚РµРіСЂР°С†С–СЏ Р· G06 (Р°РІС‚РѕР·Р±С–СЂ Р·Р°РґР°С‡/Р·РІРµРґРµРЅСЊ)",
      "status": "Planned"
    },
    {
      "id": "G04-T-20250903-P02",
      "title": "Р†РЅС‚РµРіСЂР°С†С–СЏ Р· G11 (РјР°РЅРґР°С‚Рё/РІС–РґРїРѕРІС–РґР°Р»СЊРЅС–СЃС‚СЊ)",
      "status": "Planned"
    },
    {
      "id": "G04-T-20250903-P03",
      "title": "РЎС‚Р°Р±С–Р»С–Р·СѓРІР°С‚Рё RHYTHM_DASHBOARD С– РґРѕРґР°С‚Рё Р°Р»РµСЂС‚Рё",
      "status": "Planned"
    }
  ]
}
```

**`_data/g04_protocols.json`**
```json
{
  "items": [
    {"id": "CP-01", "title": "Coordination Protocol 01", "path": "C12/Protocols/Coordination_01.md", "version": "v1.0"},
    {"id": "CP-02", "title": "Coordination Protocol 02", "path": "C12/Protocols/Coordination_02.md", "version": "v1.0"}
  ]
}
```

---

## рџ”§ Р†РЅСЃС‚Р°Р»СЏС†С–СЏ С‚Р° РїР»Р°РЅСѓРІР°Р»СЊРЅРёРє (РєРѕРјР°РЅРґРё)
1) РЎС‚СЂСѓРєС‚СѓСЂР° РґРёСЂРµРєС‚РѕСЂС–Р№:
```
mkdir C:\CHECHA_CORE\C06_FOCUS\_data -Force
mkdir C:\CHECHA_CORE\C11\C11_AUTOMATION\G04 -Force
```
2) РџРµСЂС€РёР№ Р·Р°РїСѓСЃРє:
```
pwsh -NoProfile -ExecutionPolicy Bypass -File C:\CHECHA_CORE\C11\C11_AUTOMATION\G04\Update-G04-Panel.ps1
```
3) РџР»Р°РЅСѓРІР°Р»СЊРЅРёРє (С‰РѕРіРѕРґРёРЅРё, СЏРє SYSTEM):
```
schtasks /Create /TN "G04_UpdatePanel" /SC HOURLY /MO 1 ^
 /TR "pwsh -NoProfile -ExecutionPolicy Bypass -File C:\CHECHA_CORE\C11\C11_AUTOMATION\G04\Update-G04-Panel.ps1" ^
 /ST 08:00 /RU SYSTEM
```
4) Р—Р°РїСѓСЃС‚РёС‚Рё РІСЂСѓС‡РЅСѓ Р·Р°СЂР°Р·:
```
schtasks /Run /TN G04_UpdatePanel
```

---

## рџ§° РђРІС‚РѕРіРµРЅРµСЂР°С‚РѕСЂ Р·Р°РІРґР°РЅСЊ вЂ” `Generate-G04-Tasks.ps1`
> Р¤РѕСЂРјСѓС” `C06_FOCUS/_data/g04_tasks.json` Р· Р¶СѓСЂРЅР°Р»С–РІ (`C03/LOG/*.log`) С– git-Р»РѕРіС–РІ СЂРµРїРѕР·РёС‚РѕСЂС–СЋ. Р—Р±РµСЂС–РіР°С” С–СЃРЅСѓСЋС‡С– СЃС‚Р°С‚СѓСЃРё/РІР»Р°СЃРЅРёРєС–РІ РґР»СЏ РІР¶Рµ РЅР°СЏРІРЅРёС… ID.

```powershell
[CmdletBinding()]
param(
  [string]$Root = "C:\CHECHA_CORE",
  [string]$RepoPath = "C:\CHECHA_CORE",
  [int]$HoursCritical = 48,
  [int]$DaysUrgent = 7,
  [int]$DaysPlanned = 30,
  [int]$MaxPerBucket = 5,
  [switch]$DryRun
)

$DataDir = Join-Path $Root 'C06_FOCUS\_data'
$OutJson = Join-Path $DataDir 'g04_tasks.json'
$LogDir  = Join-Path $Root 'C03\LOG'
$now = Get-Date

function Ensure-Dir($p){ if(-not (Test-Path $p)){ New-Item -ItemType Directory -Force -Path $p | Out-Null } }
function Read-Json($p){ if(Test-Path $p){ try{ Get-Content $p -Raw -Encoding UTF8 | ConvertFrom-Json } catch{ $null } } else { $null } }
function Save-Json($obj,$p){ $obj | ConvertTo-Json -Depth 6 | Set-Content -Encoding UTF8 $p }

Ensure-Dir $DataDir

# 1) Р—Р°РІР°РЅС‚Р°Р¶РёС‚Рё С–СЃРЅСѓСЋС‡С– Р·Р°РґР°С‡С– С‰РѕР± Р·Р±РµСЂРµРіС‚Рё СЃС‚Р°С‚СѓСЃ/owner РїСЂРё РѕРЅРѕРІР»РµРЅРЅС–
$existing = Read-Json $OutJson
if(-not $existing){ $existing = @{ critical_48h=@(); urgent_7d=@(); planned_30d=@() } }

# 2) РџСЂР°РІРёР»Р° (РјРѕР¶РЅР° РІРёРЅРµСЃС‚Рё Сѓ C06_FOCUS/_data/g04_rules.json)
$rules = @{
  errorKeywords = @('ERROR','FAILED','EXCEPTION','CRITICAL','FATAL','ERR')
  urgentKeywords = @('URGENT','DEADLINE','BLOCKER','HOTFIX')
  plannedKeywords = @('feat','refactor','docs','chore','release')
}

# 3) РџР°СЂСЃ Р»РѕРіС–РІ (РѕСЃС‚Р°РЅРЅС–Р№ $HoursCritical РіРѕРґРёРЅ)
$critLimit = $now.AddHours(-$HoursCritical)
$logFiles = Get-ChildItem -Path $LogDir -Filter '*.log' -File -ErrorAction SilentlyContinue | Sort-Object LastWriteTime -Descending
$critHits = @()
foreach($lf in $logFiles){
  if($lf.LastWriteTime -lt $critLimit){ break }
  $tail = Get-Content $lf -Tail 500 -ErrorAction SilentlyContinue
  foreach($ln in $tail){
    if($rules.errorKeywords | Where-Object { $ln -match $_ }){
      $critHits += [pscustomobject]@{ file=$lf.Name; when=$lf.LastWriteTime; line=$ln.Trim() }
    }
  }
}
$critHits = $critHits | Select-Object -First $MaxPerBucket

# 4) Git log (РѕСЃС‚Р°РЅРЅС– $DaysUrgent / $DaysPlanned)
function Git(@args){
  pushd $RepoPath | Out-Null
  try{ git @args } finally { popd | Out-Null }
}
$sinceUrgent = $now.AddDays(-$DaysUrgent).ToString('yyyy-MM-dd')
$sincePlanned = $now.AddDays(-$DaysPlanned).ToString('yyyy-MM-dd')
$gitUrgent = Git log "--since=$sinceUrgent" --pretty=format:"%h|%ad|%s" --date=iso 2>$null
$gitPlanned = Git log "--since=$sincePlanned" --pretty=format:"%h|%ad|%s" --date=iso 2>$null

$urgentCommits = @()
foreach($r in $gitUrgent){ $p=$r -split '\|',3; if($p.Length -lt 3){ continue }; $urgentCommits += [pscustomobject]@{ sha=$p[0]; date=$p[1]; msg=$p[2] } }
$plannedCommits = @()
foreach($r in $gitPlanned){ $p=$r -split '\|',3; if($p.Length -lt 3){ continue }; $plannedCommits += [pscustomobject]@{ sha=$p[0]; date=$p[1]; msg=$p[2] } }

# 5) РџРѕР±СѓРґРѕРІР° РЅРѕРІРёС… Р·Р°РґР°С‡
function NextId($prefix,$num){ '{0}-{1:D2}' -f $prefix,$num }
$baseDate = $now.ToString('yyyyMMdd')

# Critical
$crit = @()
$idx=1
foreach($hit in $critHits){
  $id = NextId("G04-T-$baseDate-C", $idx)
  $title = "Р РѕР·С–Р±СЂР°С‚Рё РєСЂРёС‚РёС‡РЅСѓ РїРѕРјРёР»РєСѓ Сѓ $($hit.file)"
  $notes = $hit.line
  $crit += @{ id=$id; title=$title; owner='РЎ.Р§.'; eta=($now.AddHours(24)).ToString('s')+'+03:00'; status='Pending'; notes=$notes }
  $idx++
}

# Urgent вЂ” Р· git Р·Р° 7 РґРЅС–РІ, С„С–Р»СЊС‚СЂ Р·Р° РєР»СЋС‡РѕРІРёРјРё СЃР»РѕРІР°РјРё
$urg = @()
$idx=1
foreach($c in $urgentCommits){
  if($rules.urgentKeywords | Where-Object { $c.msg -match $_ }){
    $id = NextId("G04-T-$baseDate-U", $idx)
    $urg += @{ id=$id; title=$c.msg; deadline=$now.AddDays(7).ToString('yyyy-MM-dd'); status='Planned' }
    $idx++
  }
}
$urg = $urg | Select-Object -First $MaxPerBucket

# Planned вЂ” Р· git Р·Р° 30 РґРЅС–РІ, Р·Р° РєР»СЋС‡Р°РјРё plannedKeywords
$plan = @()
$idx=1
foreach($c in $plannedCommits){
  if($rules.plannedKeywords | Where-Object { $c.msg -match $_ }){
    $id = NextId("G04-T-$baseDate-P", $idx)
    $plan += @{ id=$id; title=$c.msg; status='Planned' }
    $idx++
  }
}
$plan = $plan | Select-Object -First $MaxPerBucket

# 6) Р—Р»РёС‚С‚СЏ Р· С–СЃРЅСѓСЋС‡РёРј (Р·Р±РµСЂРµРіС‚Рё status/owner РґРµ ID Р·Р±С–РіР°С”С‚СЊСЃСЏ)
function Merge-Bucket($old,$neu){
  $map = @{}
  foreach($o in $old){ $map[$o.id] = $o }
  $out = @()
  foreach($n in $neu){
    if($map.ContainsKey($n.id)){
      $m = $map[$n.id]
      if($m.status){ $n.status = $m.status }
      if($m.owner){ $n.owner = $m.owner }
      if($m.deadline){ $n.deadline = $m.deadline }
      if($m.eta){ $n.eta = $m.eta }
    }
    $out += $n
  }
  return $out
}

$newObj = @{
  critical_48h = Merge-Bucket $existing.critical_48h $crit
  urgent_7d    = Merge-Bucket $existing.urgent_7d    $urg
  planned_30d  = Merge-Bucket $existing.planned_30d  $plan
}

if($DryRun){
  $newObj | ConvertTo-Json -Depth 6 | Write-Output
} else {
  Save-Json $newObj $OutJson
  Write-Host "вњ… Р—РіРµРЅРµСЂРѕРІР°РЅРѕ: $OutJson"
}
```

**Р’РёРєРѕСЂРёСЃС‚Р°РЅРЅСЏ:**
```
pwsh -NoProfile -ExecutionPolicy Bypass -File C:\CHECHA_CORE\C11\C11_AUTOMATION\G04\Generate-G04-Tasks.ps1 -RepoPath C:\CHECHA_CORE -DryRun
pwsh -NoProfile -ExecutionPolicy Bypass -File C:\CHECHA_CORE\C11\C11_AUTOMATION\G04\Generate-G04-Tasks.ps1 -RepoPath C:\CHECHA_CORE
```

> РџРѕСЂР°РґР°: РґРѕРґР°Р№ Сѓ СЂРѕР·РєР»Р°Рґ С‰РѕРґРµРЅРЅРёР№ Р·Р°РїСѓСЃРє Рѕ 08:15, Р° `Update-G04-Panel.ps1` вЂ” Рѕ 08:20.

```
schtasks /Create /TN "G04_GenerateTasks" /SC DAILY /ST 08:15 /RU SYSTEM ^
 /TR "pwsh -NoProfile -ExecutionPolicy Bypass -File C:\CHECHA_CORE\C11\C11_AUTOMATION\G04\Generate-G04-Tasks.ps1 -RepoPath C:\CHECHA_CORE"
```

---

## рџ©є РџРµСЂРµРІС–СЂРєР° Р·РґРѕСЂРѕРІ'СЏ вЂ” `Invoke-G04-Health.ps1`
> РЁРІРёРґРєРёР№ Р°СѓРґРёС‚ СЃС‚СЂСѓРєС‚СѓСЂРё G04: РЅР°СЏРІРЅС–СЃС‚СЊ `_data`, РІР°Р»С–РґРЅС–СЃС‚СЊ JSON, РїСЂРѕС‚РѕРєРѕР»С–РІ, РїР°РЅРµР»С–, СЏРєРѕСЂС–РІ Р·РІС–С‚С–РІ, РѕСЃС‚Р°РЅРЅС–С… Р»РѕРіС–РІ.

```powershell
[CmdletBinding()]
param(
  [string]$Root = "C:\CHECHA_CORE",
  [switch]$VerboseOnly
)

$DataDir = Join-Path $Root 'C06_FOCUS\_data'
$Tasks = Join-Path $DataDir 'g04_tasks.json'
$Prots = Join-Path $DataDir 'g04_protocols.json'
$Panel = Join-Path $Root 'C06_FOCUS\G04_PANEL.md'
$LogDir= Join-Path $Root 'C03\LOG'

$ok = $true
function Fail($m){ Write-Host "[FAIL] $m" -ForegroundColor Red; $script:ok=$false }
function Pass($m){ Write-Host "[OK]   $m" -ForegroundColor Green }
function Read-Json($p){ if(Test-Path $p){ try{ Get-Content $p -Raw -Encoding UTF8 | ConvertFrom-Json } catch{ Fail("JSON parse error: $p"); $null } } else { Fail("Missing: $p"); $null } }

# 1) Р¤Р°Р№Р»Рё
if(Test-Path $DataDir){ Pass("Exists: $DataDir") } else { Fail("Missing dir: $DataDir") }
if(Test-Path $Panel){ Pass("Exists: $Panel") } else { Fail("Missing: $Panel") }

# 2) JSON СЃС‚СЂСѓРєС‚СѓСЂР°
$t = Read-Json $Tasks
$p = Read-Json $Prots
if($t){
  foreach($k in 'critical_48h','urgent_7d','planned_30d'){
    if($t.PSObject.Properties.Name -notcontains $k){ Fail("Tasks missing key: $k") } else { Pass("Tasks has key: $k") }
  }
}
if($p){ if($p.items){ Pass("Protocols have items: $($p.items.Count)") } else { Fail("Protocols empty or missing 'items'") } }

# 3) РџСЂРѕС‚РѕРєРѕР»Рё С–СЃРЅСѓСЋС‚СЊ
if($p -and $p.items){ foreach($i in $p.items){ $path = Join-Path $Root $i.path; if(Test-Path $path){ Pass("Protocol exists: $($i.path)") } else { Fail("Protocol missing: $($i.path)") } } }

# 4) РђРЅРєРѕСЂРё Р·РІС–С‚С–РІ (РѕР±С‡РёСЃР»СЋРІР°РЅС–)
$now = Get-Date
$week = [System.Globalization.ISOWeek]::GetWeekOfYear($now)
$wk = ('{0:D2}' -f $week)
$weekly = "Reports.md#week-$($now.Year)-W$wk"
$monthly= "Reports.md#month-$($now.ToString('yyyy-MM'))"
Write-Host "[INFO] Weekly anchor: $weekly"
Write-Host "[INFO] Monthly anchor: $monthly"

# 5) Р›РѕРіРё (РѕСЃС‚Р°РЅРЅС– 2)
$logs = Get-ChildItem -Path $LogDir -Filter '*.log' -File -ErrorAction SilentlyContinue | Sort-Object LastWriteTime -Descending | Select-Object -First 2
if($logs){ Pass("Logs found: $($logs.Count)") } else { Fail("No logs in $LogDir") }

if($ok){ Write-Host "вњ… HEALTH OK" -ForegroundColor Green; exit 0 } else { Write-Host "вќЊ HEALTH FAIL" -ForegroundColor Red; exit 1 }
```

**Р—Р°РїСѓСЃРє:**
```
pwsh -NoProfile -ExecutionPolicy Bypass -File C:\CHECHA_CORE\C11\C11_AUTOMATION\G04\Invoke-G04-Health.ps1
```

---

## вљ™пёЏ РџСЂРѕРїРѕРЅРѕРІР°РЅРёР№ СЂРёС‚Рј Р°РІС‚РѕРјР°С‚РёР·Р°С†С–С—
- 08:15 вЂ” `Generate-G04-Tasks.ps1`
- 08:20 вЂ” `Update-G04-Panel.ps1`
- 08:25 вЂ” `Invoke-G04-Health.ps1` (РїРѕРІРµСЂС‚Р°С” РєРѕРґ 0/1; РјРѕР¶РЅР° РїС–РґС…РѕРїРёС‚Рё СЏРє С–РЅРґРёРєР°С‚РѕСЂ Сѓ RHYTHM_DASHBOARD)

---

## рџљЁ Р•СЃРєР°Р»Р°С†С–СЏ вЂ” `Handle-G04-Escalation.ps1`
> Р’РёРєР»РёРєР°С” health-check, РїСЂРё FAIL РґРѕРґР°С” Р·Р°РїРёСЃ Сѓ `RHYTHM_DASHBOARD.md` С– СЃС‚РІРѕСЂСЋС” **РєСЂРёС‚РёС‡РЅСѓ Р·Р°РґР°С‡Сѓ** РІ `_data/g04_tasks.json` (Р· Р°РЅС‚РёРґСѓР±Р»С–РєР°С‚РѕРј С‡РµСЂРµР· cooldown). Р’РµРґРµ Р¶СѓСЂРЅР°Р» `C03/LOG/G04_ESCALATION.log` С– **СЂРµС”СЃС‚СЂ РµСЃРєР°Р»Р°С†С–Р№** `_data/g04_escalations.json`.

```powershell
[CmdletBinding()]
param(
  [string]$Root = "C:\CHECHA_CORE",
  [string]$HealthScript = "C:\CHECHA_CORE\C11\C11_AUTOMATION\G04\Invoke-G04-Health.ps1",
  [int]$CooldownHours = 12,
  [switch]$DryRun
)

function Ensure-Dir($p){ if(-not (Test-Path $p)){ New-Item -ItemType Directory -Force -Path $p | Out-Null } }
function Read-Json($p){ if(Test-Path $p){ try{ Get-Content $p -Raw -Encoding UTF8 | ConvertFrom-Json } catch{ $null } } else { $null } }

$DataDir = Join-Path $Root 'C06_FOCUS\_data'
$TasksJson = Join-Path $DataDir 'g04_tasks.json'
$EscJson   = Join-Path $DataDir 'g04_escalations.json'
$Dash      = Join-Path $Root 'RHYTHM_DASHBOARD.md'
$Hist      = Join-Path $Root 'C03\LOG\G04_ESCALATION.log'

Ensure-Dir $DataDir
Ensure-Dir (Split-Path $Hist -Parent)

# Load state
$tasks = Read-Json $TasksJson; if(-not $tasks){ $tasks = @{ critical_48h=@(); urgent_7d=@(); planned_30d=@() } }
$esc   = Read-Json $EscJson; if(-not $esc){ $esc = @{ items=@() } }

# Run health and capture output
$healthOutput = & pwsh -NoProfile -ExecutionPolicy Bypass -File $HealthScript *>&1
$exit = $LASTEXITCODE

$ts    = Get-Date
$tsStr = $ts.ToString('yyyy-MM-dd HH:mm:ss')

if($exit -eq 0){
  $line = "[$tsStr] G04 health OK"
  if(-not $DryRun){ Add-Content -Encoding UTF8 -Path $Dash -Value $line; Add-Content -Encoding UTF8 -Path $Hist -Value $line }
  Write-Host "OK"; exit 0
}

# Parse FAIL reasons (РґРѕ 3 СЂСЏРґРєС–РІ)
$failLines = $healthOutput | Where-Object { $_ -match '^\[FAIL\]|HEALTH FAIL' } | Select-Object -First 3
$reason = if($failLines){ ($failLines -join ' | ') } else { 'Unknown failure' }

# Cooldown (Р°РЅС‚РёРґСѓР±Р»СЊ)
function WithinCooldown($item){ try{ $t=[datetime]::Parse($item.ts) } catch { return $false }; return (($ts - $t).TotalHours -lt $CooldownHours -and $item.reason -eq $reason) }
$dupe = $esc.items | Where-Object { WithinCooldown $_ } | Select-Object -First 1
if($dupe){
  $line = "[$tsStr] G04 health FAIL; SKIP escalate (cooldown); Reason=$reason"
  if(-not $DryRun){ Add-Content -Path $Dash -Encoding UTF8 -Value $line; Add-Content -Path $Hist -Encoding UTF8 -Value $line }
  Write-Warning "Cooldown active"; exit 2
}

# Build new critical task ID
$today  = $ts.ToString('yyyyMMdd')
$prefix = "G04-T-$today-C"
$existingToday = @(); foreach($t in $tasks.critical_48h){ if($t.id -match "^$prefix(?:-(\d+))?$"){ $existingToday += $t } }
$next = 1; $max=0
foreach($t in $existingToday){ if($t.id -match "^$prefix-(\d+)$"){ $n=[int]$Matches[1]; if($n -gt $max){ $max=$n } } }
if($max -gt 0){ $next = $max + 1 }
$id = if($next -eq 1 -and -not ($tasks.critical_48h | Where-Object { $_.id -eq $prefix })) { $prefix } else { "$prefix-$('{0:D2}' -f $next)" }

$eta = ($ts.AddHours(24)).ToString('s') + '+03:00'
$newTask = @{ id=$id; title='Р•СЃРєР°Р»Р°С†С–СЏ: РІРёРїСЂР°РІРёС‚Рё РїРѕРјРёР»РєРё Р· health-check G04'; owner='OnвЂ‘duty'; eta=$eta; status='Pending'; notes=$reason }

# Prepend (top) С– С‚СЂРёРјР°С‚Рё РїРµСЂС€С– 10
$tasks.critical_48h = @($newTask) + @($tasks.critical_48h) | Select-Object -First 10

if(-not $DryRun){
  $tasks | ConvertTo-Json -Depth 6 | Set-Content -Encoding UTF8 $TasksJson
  $esc.items = @(@{ id=$id; ts=$ts.ToString('s'); reason=$reason; cooldown_h=$CooldownHours }) + @($esc.items) | Select-Object -First 50
  $esc | ConvertTo-Json -Depth 6 | Set-Content -Encoding UTF8 $EscJson
  $line = "[$tsStr] G04 health FAIL; Task=$id; Reason=$reason"
  Add-Content -Encoding UTF8 -Path $Dash -Value $line
  Add-Content -Encoding UTF8 -Path $Hist -Value $line
}

Write-Host "Escalated: $id"; exit 1
```

### РџС–РґРєР»СЋС‡РµРЅРЅСЏ Сѓ СЂРѕР·РєР»Р°Рґ
> Р РµРєРѕРјРµРЅРґСѓС”С‚СЊСЃСЏ Р·Р°РїСѓСЃРєР°С‚Рё РїС–СЃР»СЏ РѕРЅРѕРІР»РµРЅРЅСЏ РїР°РЅРµР»С–.
```
mkdir C:\CHECHA_CORE\C11\C11_AUTOMATION\G04 -Force
pwsh -NoProfile -ExecutionPolicy Bypass -File C:\CHECHA_CORE\C11\C11_AUTOMATION\G04\Handle-G04-Escalation.ps1 -DryRun

schtasks /Create /TN "G04_HealthEscalate" /SC DAILY /ST 08:25 /RU SYSTEM ^
 /TR "pwsh -NoProfile -ExecutionPolicy Bypass -File C:\CHECHA_CORE\C11\C11_AUTOMATION\G04\Handle-G04-Escalation.ps1"
```

**Р РµР·СѓР»СЊС‚Р°С‚:** РїСЂРё `FAIL` Р·КјСЏРІР»СЏС”С‚СЊСЃСЏ Р·Р°РїРёСЃ Сѓ `RHYTHM_DASHBOARD.md` С„РѕСЂРјР°С‚Сѓ:
```
[YYYY-MM-DD HH:MM:SS] G04 health FAIL; Task=G04-T-YYYYMMDD-Cxx; Reason=<РєРѕСЂРѕС‚РєРѕ>
```
С– СЃС‚РІРѕСЂСЋС”С‚СЊСЃСЏ РєСЂРёС‚РёС‡РЅР° Р·Р°РґР°С‡Р° Сѓ `_data/g04_tasks.json` Р· ETA +24 РіРѕРґРёРЅРё.

---

## рџ”” РџРѕРІС–РґРѕРјР»РµРЅРЅСЏ (Telegram & Email) вЂ” `Notify-G04.ps1`
> РЈРЅС–РІРµСЂСЃР°Р»СЊРЅРёР№ РЅРѕС‚РёС„С–РєР°С‚РѕСЂ РґР»СЏ РµСЃРєР°Р»Р°С†С–Р№/РѕРЅРѕРІР»РµРЅСЊ РїР°РЅРµР»С–. РџС–РґС‚СЂРёРјСѓС” Telegram С‚Р° Email. РЎРµРєСЂРµС‚Рё вЂ” С‡РµСЂРµР· envвЂ‘Р·РјС–РЅРЅС– Р°Р±Рѕ `_data/g04_notify.json`.

**РџСЂРёРєР»Р°Рґ `_data/g04_notify.json`:**
```json
{
  "telegram": {"enabled": true, "bot_token": "${ENV:G04_TG_BOT}", "chat_id": "${ENV:G04_TG_CHAT}"},
  "email": {"enabled": false, "smtp_server": "smtp.gmail.com", "port": 587, "from": "dao.gogs.ua@gmail.com", "to": ["you@example.com"], "use_ssl": true}
}
```

```powershell
[CmdletBinding()]
param(
  [string]$Root = "C:\CHECHA_CORE",
  [switch]$DryRun
)

$ConfigPath = Join-Path $Root 'C06_FOCUS\_data\g04_notify.json'
function Read-Json($p){ if(Test-Path $p){ try{ Get-Content $p -Raw -Encoding UTF8 | ConvertFrom-Json } catch{ $null } } else { $null } }
$CFG = Read-Json $ConfigPath

function Get-EnvOr([string]$name,[string]$fallback){ if($env:$name){ return $env:$name } else { return $fallback } }

function Send-Telegram([string]$text){
  if(-not $CFG.telegram.enabled){ return }
  $token = Get-EnvOr 'G04_TG_BOT' $CFG.telegram.bot_token
  $chat  = Get-EnvOr 'G04_TG_CHAT' $CFG.telegram.chat_id
  if(-not $token -or -not $chat){ Write-Warning 'Telegram not configured'; return }
  $uri = "https://api.telegram.org/bot$token/sendMessage"
  $body = @{ chat_id=$chat; text=$text; disable_web_page_preview=$true }
  if($DryRun){ Write-Host "[DryRun] TG -> $chat: $text" -ForegroundColor Yellow; return }
  try{ Invoke-RestMethod -Method Post -Uri $uri -ContentType 'application/json' -Body ($body | ConvertTo-Json -Depth 5) | Out-Null; Write-Host 'TG sent' -ForegroundColor Green } catch { Write-Warning $_ }
}

function Send-Email([string]$subject,[string]$text){
  if(-not $CFG.email.enabled){ return }
  $srv=$CFG.email.smtp_server; $port=$CFG.email.port; $from=$CFG.email.from; $to=$CFG.email.to -join ','; $ssl=$CFG.email.use_ssl
  $user = Get-EnvOr 'G04_SMTP_USER' $null
  $pass = Get-EnvOr 'G04_SMTP_PASS' $null
  if($DryRun){ Write-Host "[DryRun] MAIL -> $to | $subject" -ForegroundColor Yellow; return }
  try{
    Send-MailMessage -SmtpServer $srv -Port $port -UseSsl:$ssl -From $from -To $to -Subject $subject -Body $text -Encoding UTF8 -Credential (New-Object System.Management.Automation.PSCredential($user,(ConvertTo-SecureString $pass -AsPlainText -Force)))
    Write-Host 'Email sent' -ForegroundColor Green
  } catch { Write-Warning $_ }
}

function Send-G04Notification([string]$title,[string]$text,[string[]]$channels=@('Telegram','Email')){
  $stamp = (Get-Date).ToString('yyyy-MM-dd HH:mm:ss')
  $msg = "[$stamp] $title`n$text"
  if($channels -contains 'Telegram'){ Send-Telegram $msg }
  if($channels -contains 'Email'){ Send-Email $title $msg }
}

Export-ModuleMember -Function Send-G04Notification
```

**Р†РЅС–С†С–Р°Р»С–Р·Р°С†С–СЏ СЃРµРєСЂРµС‚С–РІ (User env):**
```
[Environment]::SetEnvironmentVariable('G04_TG_BOT','<bot-token>','User')
[Environment]::SetEnvironmentVariable('G04_TG_CHAT','<chat-id>','User')
# Р—Р° РїРѕС‚СЂРµР±Рё email:
[Environment]::SetEnvironmentVariable('G04_SMTP_USER','dao.gogs.ua@gmail.com','User')
[Environment]::SetEnvironmentVariable('G04_SMTP_PASS','<app-password>','User')
```

**РўРµСЃС‚ РїРѕРІС–РґРѕРјР»РµРЅРЅСЏ:**
```
pwsh -NoProfile -File C:\CHECHA_CORE\C11\C11_AUTOMATION\G04\Notify-G04.ps1 -DryRun
```

---

## рџ“€ РЎС‚Р°С‚РёСЃС‚РёРєР° РµСЃРєР°Р»Р°С†С–Р№ вЂ” `Build-G04-Stats.ps1` + `Update-G04-Panel.ps1 (v1.1)`
> Р“РµРЅРµСЂСѓС” `_data/g04_stats.json` С– РІРёРІРѕРґРёС‚СЊ СЃРµРєС†С–СЋ СЃС‚Р°С‚РёСЃС‚РёРєРё Сѓ РїР°РЅРµР»С– (Р·Р° 24 РіРѕРґ, 7 РґРЅС–РІ, 30 РґРЅС–РІ + РѕСЃС‚Р°РЅРЅСЏ РїСЂРёС‡РёРЅР°; РєС–Р»СЊРєС–СЃС‚СЊ РІС–РґРєСЂРёС‚РёС… РєСЂРёС‚РёС‡РЅРёС…).

```powershell
# Build-G04-Stats.ps1
[CmdletBinding()]param([string]$Root='C:\CHECHA_CORE')
$Data=Join-Path $Root 'C06_FOCUS\_data'; $Esc=Join-Path $Data 'g04_escalations.json'; $Tasks=Join-Path $Data 'g04_tasks.json'; $Out=Join-Path $Data 'g04_stats.json'
function RJ($p){ if(Test-Path $p){ Get-Content $p -Raw -Encoding UTF8 | ConvertFrom-Json } }
$e=RJ $Esc; $t=RJ $Tasks; $now=Get-Date
$items = @(); if($e -and $e.items){ $items=$e.items }
function Cnt($d){ ($items | Where-Object { try{ ([datetime]$_.ts) -gt $d } catch { $false } }).Count }
$openCrit = 0; if($t -and $t.critical_48h){ $openCrit = ($t.critical_48h | Where-Object { $_.status -match 'Pending|In-Progress' }).Count }
$out = [ordered]@{
  last24h = Cnt($now.AddHours(-24));
  last7d  = Cnt($now.AddDays(-7));
  last30d = Cnt($now.AddDays(-30));
  last_reason = $(if($items){ $items[0].reason } else { $null });
  open_critical = $openCrit
}
$out | ConvertTo-Json -Depth 4 | Set-Content -Encoding UTF8 $Out
Write-Host "вњ… $Out"
```

**`Update-G04-Panel.ps1 (v1.1)` вЂ” СЃРµРєС†С–СЏ СЃС‚Р°С‚РёСЃС‚РёРєРё (РІСЃС‚Р°РІР»РµРЅР° РїС–СЃР»СЏ Р»РѕРіС–РІ):**
```powershell
# ... Сѓ РІРµСЂС…РЅС–Р№ С‡Р°СЃС‚РёРЅС– РґРѕРґР°С‚Рё РїРѕСЂСѓС‡ Р· С–РЅС€РёРјРё С€Р»СЏС…Р°РјРё:
$StatsJson = Join-Path $DataDir 'g04_stats.json'
$S = if(Test-Path $StatsJson){ try{ Get-Content $StatsJson -Raw | ConvertFrom-Json } catch { $null } } else { $null }

# ... РїС–СЃР»СЏ Р±Р»РѕРєСѓ "# Logs digest section" С‚Р° РїРµСЂРµРґ # Output РґРѕРґР°С‚Рё:
$md += "
## рџ“€ Р•СЃРєР°Р»Р°С†С–С— вЂ” СЃС‚Р°С‚РёСЃС‚РёРєР°"
if($S){
  $md += "- Р—Р° 24 РіРѕРґ: **$($S.last24h)**"
  $md += "- Р—Р° 7 РґРЅС–РІ: **$($S.last7d)**"
  $md += "- Р—Р° 30 РґРЅС–РІ: **$($S.last30d)**"
  if($S.last_reason){ $md += "- РћСЃС‚Р°РЅРЅСЏ РїСЂРёС‡РёРЅР°: $($S.last_reason)" }
  $md += "- Р’С–РґРєСЂРёС‚С– РєСЂРёС‚РёС‡РЅС–: **$($S.open_critical)**"
} else {
  $md += "- (СЃС‚Р°С‚РёСЃС‚РёРєСѓ С‰Рµ РЅРµ Р·РіРµРЅРµСЂРѕРІР°РЅРѕ)"
}
```

**Р РѕР·РєР»Р°Рґ (РґРѕРїРѕРІРЅРµРЅРЅСЏ):**
```
# РЎС‚Р°С‚РёСЃС‚РёРєР° Рѕ 08:18
schtasks /Create /TN "G04_BuildStats" /SC DAILY /ST 08:18 /RU SYSTEM ^
 /TR "pwsh -NoProfile -ExecutionPolicy Bypass -File C:\CHECHA_CORE\C11\C11_AUTOMATION\G04\Build-G04-Stats.ps1"

# РћРЅРѕРІР»РµРЅРЅСЏ РїР°РЅРµР»С– Р·Р°Р»РёС€Р°С”РјРѕ РЅР° 08:20 (РІР¶Рµ РЅР°Р»Р°С€С‚РѕРІР°РЅРѕ)
```

---

## рџ”— Р†РЅС‚РµРіСЂР°С†С–СЏ РЅРѕС‚РёС„С–РєР°С†С–Р№ РІ РµСЃРєР°Р»Р°С†С–СЋ
> Р”РѕРґР°Р№ Сѓ `Handle-G04-Escalation.ps1` РїС–СЃР»СЏ С„РѕСЂРјСѓРІР°РЅРЅСЏ `$newTask`:
```powershell
# Notify (Telegram / Email)
$Notify = 'C:\CHECHA_CORE\C11\C11_AUTOMATION\G04\Notify-G04.ps1'
. $Notify
$ttl = "[G04] HEALTH FAIL вЂ” $id"
$txt = "РџСЂРёС‡РёРЅР°: $reason`nETA: $eta`nOwner: On-duty"
Send-G04Notification -title $ttl -text $txt -channels @('Telegram')
```

**РўРµСЃС‚ РЅРѕС‚РёС„С–РєР°С†С–Р№ (DryRun):**
```
pwsh -NoProfile -File C:\CHECHA_CORE\C11\C11_AUTOMATION\G04\Notify-G04.ps1 -DryRun
```

